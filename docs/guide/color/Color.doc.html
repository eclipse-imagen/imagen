<html><head><title>Color Space</title></head>
<body bgcolor=#ffffff>
 
<center>
<a href="JAITOC.fm.html"><img src="shared/contents.gif" alt="Contents"></a> <a href="Acquisition.doc.html"><img src="shared/previous.gif" alt="Previous"></a> <a href="Image-manipulation.doc.html"><img src="shared/next.gif" alt="Next"></a> <p><font size=5><i>Programming in Java Advanced Imaging</i></font>
</center>
<br>
 
<center>
<a name="47227">
<table width=90% border=0><tr>
<td align=right><font size=3>C H A P T E R</font><font size=7><img src="shared/sm-space.gif">5</td></table>
</a></center><center>
<a name="47285">
<table width=90% border=0><tr><td align=right>
<hr size=7 noshade>
<font size=6>Color Space</font></td></table>
</a></center><blockquote>
<p><br><br><br><P><font size=7><b>T</b></font>HIS chapter describes the JAI color space, transparency, and the color conversion operators. JAI follows the Java AWT color model.
<p><a name="51145">
<h2>5.1	<img src="shared/space.gif">Introduction</h2>
</a>Digital images, specifically digital color images, come in several different forms. The form is often dictated by the means by which the image was acquired or by the image's intended use.
<p>One of the more basic types of color image is RGB, for the three primary colors (red, green, and blue). RGB images are sometimes acquired by a color scanner or video camera. These devices incorporate three sensors that are spectrally sensitive to light in the red, green, and blue portions of the spectrum. The three separate red, green, and blue values can be made to directly drive red, green, and blue light guns in a CRT. This type of color system is called an <em>additive</em> linear RGB color system, as the sum of the three full color values produces white.
<p>Printed color images are based on a <em>subtractive</em> color process in which cyan, magenta, and yellow (CMY) dyes are deposited onto paper. The amount of dye deposited is subtractively proportional to the amount of each red, blue, and green color value. The sum of the three CMY color values produce black.
<p>The black produced by a CMY color system often falls short of being a true black. To produce a more accurate black in printed images, black is often added as a fourth color component. This is known as the CMYK color system and is commonly used in the printing industry.
<p>The amount of light generated by the red, blue, and green phosphors of a CRT is not linear. To achieve good display quality, the red, blue, and green values must be adjusted - a process known as <em>gamma correction</em>. In computer systems, gamma correction often takes place in the frame buffer, where the RGB values are passed through lookup tables that are set with the necessary compensation values.
<p>In television transmission systems, the red, blue, and green gamma-corrected color video signals are not transmitted directly. Instead, a linear transformation between the RGB components is performed to produce a <em>luminance</em> signal and a pair of <em>chrominance</em> signals. The luminance signal conveys color brightness levels. The two chrominance signals convey the color hue and saturation. This color system is called YCC (or, more specifically, YC<sub>b</sub>C<sub>r</sub>).
<p>Another significant color space standard for JAI is CIEXYZ. This is a widely-used, device-independent color standard developed by the Commission Internationale de l'&Eacute;clairage (CIE). The CIEXYZ standard is based on color-matching experiments on human observers.
<p><a name="51219">
<h2>5.2	<img src="shared/space.gif">Color Management</h2>
</a>JAI uses three primary classes for the management of color:
<p><ul>
<li><code>ColorModel</code> - describes a particular way that pixel values are mapped to colors. A <code>ColorModel</code> is typically associated with an <code>Image</code> or <code>BufferedImage</code> and provides the information necessary to correctly interpret pixel values. <code>ColorModel</code> is defined in the <code>java.awt.image</code> package.<p></ul><ul>
<li><code>ColorSpace</code> - represents a system for measuring colors, typically using three separate values or components. The <code>ColorSpace</code> class contains methods for converting between the original color space and one of two standard color spaces, CIEXYZ and RGB. <code>ColorSpace</code> is defined in the <code>java.awt.color</code> package.<p></ul><ul>
<li><code>Color</code> - a fixed color, defined in terms of its components in a particular <code>ColorSpace</code>. <code>Color</code> is defined in the <code>java.awt</code> package.<p></ul><a name="51226">
<h3>5.2.1	<img src="shared/space.gif">Color Models</h3>
</a>A <code>ColorModel</code> is used to interpret pixel data in an image. This includes:
<p><ul>
<li>Mapping components in the bands of an image to components of a particular color space<p></ul><ul>
<li>Extracting pixel components from packed pixel data<p></ul><ul>
<li>Retrieving multiple components from a single band using masks<p></ul><ul>
<li>Converting pixel data through a lookup table<p></ul>To determine the color value of a particular pixel in an image, you need to know how the color information is encoded in each pixel. The <code>ColorModel</code> associated with an image encapsulates the data and methods necessary for translating a pixel value to and from its constituent color components.
<p>JAI supports five color models:
<p><ul>
<li><code>DirectColorModel</code> - works with pixel values that represent RGB color and alpha information as separate samples and that pack all samples for a single pixel into a single int, short, or byte quantity. This class can be used only with ColorSpaces of type <code>ColorSpace.TYPE_RGB</code>.<p></ul><ul>
<li><code>IndexColorModel</code> - works with pixel values consisting of a single sample that is an index into a fixed colormap in the default sRGB ColorSpace. The colormap specifies red, green, blue, and optional alpha components corresponding to each index.<p></ul><ul>
<li><code>ComponentColorModel</code> - can handle an arbitrary <code>ColorSpace</code> and an array of color components to match the <code>ColorSpace</code>. This model can be used to represent most color models on most types of <code>GraphicsDevices</code>.<p></ul><ul>
<li><code>PackedColorModel</code> - a base class for models that represent pixel values in which the color components are embedded directly in the bits of an integer pixel. A <code>PackedColorModel</code> stores the packing information that describes how color and alpha components are extracted from the channel. The <code>DirectColorModel</code> is a <code>PackedColorModel</code>.<p></ul><ul>
<li><code>FloatDoubleColorModel</code> - works with pixel values that represent color and alpha information as separate samples, using float or double elements.<p></ul>The following sample code shows the construction of a <code>ComponentColorModel</code> for an RGB color model.<p>
<caption><font size=-1><b></b></font></caption>
<hr>
<tr valign=top><td colspan=1 rowspan=7><pre>     // Create an RGB color model
     int[] bits = { 8, 8, 8 };
     ColorModel colorModel = new
      ComponentColorModel(ColorSpace.getInstance(ColorSpace.CS_sRGB),
                          bits, false, false,
                          Transparency.OPAQUE,
                          DataBuffer.TYPE_BYTE);
</pre>
<tr valign=top>
<tr valign=top>
<tr valign=top>
<tr valign=top>
<tr valign=top>
<tr valign=top>

<hr>

<p>The following sample code shows the construction of a <code>ComponentColorModel</code> for a grayscale color model.<p>
<caption><font size=-1><b></b></font></caption>
<hr>
<tr valign=top><td colspan=1 rowspan=6><pre>     // Create a grayscale color model.
     ColorSpace cs = ColorSpace.getInstance(ColorSpace.CS_GRAY);
     int bits[] = new int[] {8};
     ColorModel cm = new ComponentColorModel(cs, bits, false, false,
                                             Transparency.OPAQUE,
                                             DataBuffer.TYPE_BYTE);
</pre>
<tr valign=top>
<tr valign=top>
<tr valign=top>
<tr valign=top>
<tr valign=top>

<hr>

<p>The following sample code shows the construction of a <code>FloatDoubleColorModel</code> for a linear RGB color model.<p>
<caption><font size=-1><b></b></font></caption>
<hr>
<tr valign=top><td colspan=1 rowspan=9><pre>     ColorSpace colorSpace =
         ColorSpace.getInstance(ColorSpace.CS_LINEAR_RGB);
     int[] bits = new int[3];
     bits[0] = bits[1] = bits[2] = 32;
     ColorModel cm = new FloatDoubleColorModel(colorSpace,
                                               false,
                                               false,
                                               Transparency.OPAQUE,
                                               DataBuffer.TYPE_FLOAT);
</pre>
<tr valign=top>
<tr valign=top>
<tr valign=top>
<tr valign=top>
<tr valign=top>
<tr valign=top>
<tr valign=top>
<tr valign=top>

<hr>

<p><table border = 0>
<tr>
<td><img src = "shared/cistine.gif"></td>
<td><hr>
<b>API:</b> <code>java.awt.image.ComponentColorModel
</code>
<hr>
</td>
</table><pre><ul>
<li>ComponentColorModel(ColorSpace colorSpace, int[] bits, 
       boolean &#32;hasAlpha, boolean isAlphaPremultiplied, 
       int &#32;transparency, int transferType)
<p></ul></pre><dl>
<a name="51303">
<dt><dd> constructs a <code>ComponentColorModel</code> from the specified parameters.<p> 
<Table Border="3" cellpadding=3>
<caption><font size=-1><b></b></font></caption>
<tr valign=top><td><em>Parameters</em>:<em></em>
<p><td><code>colorSpace</code>
<p><td>The <code>ColorSpace</code> associated with this color model. See <a href="Color.doc.html#51305">Section &#32;5.2.2, "Color Space</a>."
<p>
<tr valign=top><td>
<p><td><code>bits</code>
<p><td>The number of significant bits per component.
<p>
<tr valign=top><td>
<p><td><code>hasAlpha</code>
<p><td>If true, this color model supports alpha.
<p>
<tr valign=top><td>
<p><td><code>isAlphaPremultiplied</code>
<p><td>If true, alpha is premultiplied.
<p>
<tr valign=top><td>
<p><td><code>transparency</code>
<p><td>Specifies what alpha values can be represented by this color model. See <a href="Color.doc.html#51516">Section &#32;5.3, "Transparency</a>."
<p>
<tr valign=top><td>
<p><td><code>transferType</code>
<p><td>Specifies the type of primitive array used to represent pixel values. One of <code>DataBuffer.TYPE_BYTE</code>, <code>DataBuffer.TYPE_INT</code>, <code>DataBuffer.TYPE_SHORT</code>, <code>DataBuffer.TYPE_USHORT</code>, <code>DataBuffer.TYPE_DOUBLE</code>, or <code>DataBuffer.TYPE_FLOAT</code>
<p>

</Table>

</a><P></dl>
<table border = 0>
<tr>
<td><img src = "shared/cistine.gif"></td>
<td><hr>
<b>API:</b> <code>javax.media.jai.FloatDoubleColorModel
</code>
<hr>
</td>
</table><pre><ul>
<li>FloatDoubleColorModel(ColorSpace colorSpace, boolean hasAlpha, 
       boolean isAlphaPremultiplied, int transparency, 
       int &#32;transferType)
<p></ul></pre><dl>
<a name="51988">
<dt><dd> constructs a <code>FloatDoubleColorModel</code> from the specified parameters.<p> 
<Table Border="3" cellpadding=3>
<caption><font size=-1><b></b></font></caption>
<tr valign=top><td colspan=1 rowspan=5><em>Parameters</em>:<em></em>
<p><td><code>colorSpace</code>
<p><td>The <code>ColorSpace</code> associated with this color model. See <a href="Color.doc.html#51305">Section &#32;5.2.2, "Color Space</a>."
<p>
<tr valign=top><td><code>hasAlpha</code>
<p><td>If true, this color model supports alpha.
<p>
<tr valign=top><td><code>isAlphaPremultiplied</code>
<p><td>If true, alpha is premultiplied.
<p>
<tr valign=top><td><code>transparency</code>
<p><td>Specifies what alpha values can be represented by this color model. See <a href="Color.doc.html#51516">Section &#32;5.3, "Transparency</a>."
<p>
<tr valign=top><td><code>transferType</code>
<p><td>Specifies the type of primitive array used to represent pixel values. One of <code>DataBuffer.TYPE_FLOAT</code> or <code>DataBuffer.TYPE_DOUBLE</code>.
<p>

</Table>

</a><P></dl>
<a name="51305">
<h3>5.2.2	<img src="shared/space.gif">Color Space</h3>
</a>The <code>ColorSpace</code> class represents a system for measuring colors, typically using three or more separate numeric values. For example, RGB and CMYK are color spaces. A <code>ColorSpace</code> object serves as a color space tag that identifies the specific color space of a <code>Color</code> object or, through a <code>ColorModel</code> object, of an <code>Image</code>, <code>BufferedImage</code>, or <code>GraphicsConfiguration</code>.
<p><code>ColorSpace</code> provides methods that transform <code>Colors</code> in a specific color space to and from <code>sRGB</code> and to and from a well-defined <code>CIEXYZ</code> color space. All <code>ColorSpace</code> objects must be able to map a color from the represented color space into <code>sRGB</code> and transform an <code>sRGB</code> color into the represented color space.
<p><a href="Color.doc.html#51319">Table &#32;5-1</a> lists the variables used to refer to color spaces (such as <code>CS_sRGB</code> and <code>CS_CIEXYZ</code>) and to color space types (such as <code>TYPE_RGB</code> and <code>TYPE_CMYK</code>).<p> 
<Table Border="3" cellpadding=3>
<caption><font size=-1><b><a name="51319">
<i>Table 5-1	 </i><img src="shared/sm-blank.gif" border=0> Color Space Types &#32;
</a></b></font></caption>
<tr valign=top><th><a name="51323">
Name
</a><th><a name="51325">
Description
</a>
<tr valign=top><td><a name="51328">
CS_CIEXYZ</a><br><td><a name="51330">
A widely-used, device-independent color standard developed by the Commission Internationale de Eclairage (CIE), based on color-matching experiments on human observers.</a><br>
<tr valign=top><td><a name="51333">
CS_GRAY</a><br><td><a name="51335">
Grayscale color space.</a><br>
<tr valign=top><td><a name="51338">
CS_LINEAR_RGB</a><br><td><a name="51340">
Linear RGB. Images that have not been previously color-corrected.</a><br>
<tr valign=top><td><a name="51343">
CS_PYCC</a><br><td><a name="51345">
PhotoCD YCC conversion color space. A luminance/chrominance standard for Kodak PhotoCD images.</a><br>
<tr valign=top><td><a name="51348">
CS_sRGB</a><br><td><a name="51351">
A proposed default "standard RGB" color standard for use over the Internet.</a><br>
<tr valign=top><td><a name="51353">
TYPE_2CLR</a><br><td><a name="51355">
A generic two-component color space.</a><br>
<tr valign=top><td><a name="51357">
TYPE_3CLR</a><br><td><a name="51359">
A generic three-component color space.</a><br>
<tr valign=top><td><a name="51361">
TYPE_4CLR</a><br><td><a name="51363">
A generic four-component color space.</a><br>
<tr valign=top><td><a name="51365">
TYPE_5CLR</a><br><td><a name="51367">
A generic five-component color space.</a><br>
<tr valign=top><td><a name="51369">
TYPE_6CLR</a><br><td><a name="51371">
A generic six-component color space.</a><br>
<tr valign=top><td><a name="51373">
TYPE_7CLR</a><br><td><a name="51375">
A generic seven-component color space.</a><br>
<tr valign=top><td><a name="51377">
TYPE_8CLR</a><br><td><a name="51379">
A generic eight-component color space.</a><br>
<tr valign=top><td><a name="51381">
TYPE_9CLR</a><br><td><a name="51383">
A generic nine-component color space.</a><br>
<tr valign=top><td><a name="51385">
TYPE_ACLR</a><br><td><a name="51387">
A generic 10-component color space.</a><br>
<tr valign=top><td><a name="51389">
TYPE_BCLR</a><br><td><a name="51391">
A generic 11-component color space.</a><br>
<tr valign=top><td><a name="51393">
TYPE_CCLR</a><br><td><a name="51395">
A generic 12-component color space.</a><br>
<tr valign=top><td><a name="51397">
TYPE_CMY</a><br><td><a name="51399">
Any of the family of CMY color spaces.</a><br>
<tr valign=top><td><a name="51401">
TYPE_CMYK</a><br><td><a name="51403">
Any of the family of CMYK color spaces.</a><br>
<tr valign=top><td><a name="51405">
TYPE_DCLR</a><br><td><a name="51407">
Generic 13-component color spaces.</a><br>
<tr valign=top><td><a name="51409">
TYPE_ECLR</a><br><td><a name="51411">
Generic 14-component color spaces.</a><br>
<tr valign=top><td><a name="51413">
TYPE_FCLR</a><br><td><a name="51415">
Generic 15-component color spaces.</a><br>
<tr valign=top><td><a name="51417">
TYPE_GRAY</a><br><td><a name="51419">
Any of the family of GRAY color spaces.</a><br>
<tr valign=top><td><a name="51421">
TYPE_HLS</a><br><td><a name="51423">
Any of the family of HLS color spaces.</a><br>
<tr valign=top><td><a name="51425">
TYPE_HSV</a><br><td><a name="51427">
Any of the family of HSV color spaces.</a><br>
<tr valign=top><td><a name="51429">
TYPE_Lab</a><br><td><a name="51431">
Any of the family of Lab color spaces.</a><br>
<tr valign=top><td><a name="51433">
TYPE_Luv</a><br><td><a name="51435">
Any of the family of Luv color spaces.</a><br>
<tr valign=top><td><a name="51437">
TYPE_RGB</a><br><td><a name="51439">
Any of the family of RGB color spaces.</a><br>
<tr valign=top><td><a name="51441">
TYPE_XYZ</a><br><td><a name="51443">
Any of the family of XYZ color spaces.</a><br>
<tr valign=top><td><a name="51445">
TYPE_YCbCr</a><br><td><a name="51447">
Any of the family of YCbCr color spaces.</a><br>
<tr valign=top><td><a name="51449">
TYPE_Yxy</a><br><td><a name="51451">
Any of the family of Yxy color spaces.</a><br>

</Table>

<p>Conversion between Java color spaces is simplified by a set of methods that map a color from a represented color space to either sRGB or CIEXYZ and transform a sRGB or CIEXYZ color space to the represented color space. There are four methods:
<p><ul>
<li>The <code>toRGB</code> method transforms a <code>Color</code> in the represented color space to a <code>Color</code> in sRGB.<p></ul><ul>
<li>The <code>toCIEXYZ</code> method transforms a <code>Color</code> in the represented color space to a <code>Color</code> in CIEXYZ.<p></ul><ul>
<li>The <code>fromRGB</code> method takes a <code>Color</code> in sRGB and transforms into the represented color space.<p></ul><ul>
<li>The <code>fromCIEXYZ</code> method takes a <code>Color</code> in CIEXYZ and transforms into the represented color space.<p></ul>The sRGB (which stands for "standard" RGB) color space is provided as a convenience to programmers, since many applications are primarily concerned with RGB images. Defining a standard RGB color space makes writing such applications easier. The <code>toRGB</code> and <code>fromRGB</code> methods are provided so that developers can easily retrieve colors in this standard space. However, the sRGB color space is not intended for use with highly accurate color correction or conversions.
<p>The sRGB color space is somewhat limited in that it cannot represent every color in the full gamut (spectrum of representable colors) of CIEXYZ color. If a color is specified in some space that has a different gammut than sRGB, using sRGB as an intermediate color space results in a loss of information. The CIEXYZ color space is used as an intermediate color space to avoid any loss of color quality. The CIEXYZ color space is known as the <em>conversion space</em> for this reason. The <code>toCIEXYZ</code> and <code>fromCIEXYZ</code> methods support conversions between any two color spaces at a reasonably high degree of accuracy, one color at a time.
<p><table border = 0>
<tr>
<td><img src = "shared/cistine.gif"></td>
<td><hr>
<b>API:</b> <code>java.awt.color.ColorSpace
</code>
<hr>
</td>
</table><pre><ul>
<li>abstract float[] toRGB(float[] colorvalue)
<p></ul></pre><dl>
<a name="51468">
<dt><dd> transforms a color value assumed to be in this <code>ColorSpace</code> into a value in the default <code>CS_sRGB</code> color space.<p> 
<Table Border="3" cellpadding=3>
<caption><font size=-1><b></b></font></caption>
<tr valign=top><td><em>Parameter</em>:<em></em>
<p><td><code>colorvalue</code>
<p><td>A float array with length of at least the number of components in this <code>ColorSpace</code>.<code></code>
<p>

</Table>

</a><P></dl>
<pre><ul>
<li>abstract float[] fromRGB(float[] rgbvalue)
<p></ul></pre><dl>
<a name="51477">
<dt><dd> transforms a color value assumed to be in the default <code>CS_sRGB</code> color space into this <code>ColorSpace</code>.<p> 
<Table Border="3" cellpadding=3>
<caption><font size=-1><b></b></font></caption>
<tr valign=top><td><em>Parameter</em>:
<p><td><code>rgbvalue</code>
<p><td>A float array with length of at least 3.
<p>

</Table>

</a><P></dl>
<pre><ul>
<li>abstract float[] toCIEXYZ(float[] colorvalue)
<p></ul></pre><dl>
<a name="51486">
<dt><dd> transforms a color value assumed to be in this <code>ColorSpace</code> into the <code>CS_CIEXYZ</code> conversion color space.
</a><P></dl>
<pre><ul>
<li>abstract float[] fromCIEXYZ(float[] colorvalue)
<p></ul></pre><dl>
<a name="51488">
<dt><dd> transforms a color value assumed to be in the <code>CS_CIEXYZ</code> conversion color space into this <code>ColorSpace</code>.
</a><P></dl>
<pre><ul>
<li>static ColorSpace getInstance(int colorspace)
<p></ul></pre><dl>
<a name="51497">
<dt><dd> returns a ColorSpace representing one of the specific predefined color spaces.<p> 
<Table Border="3" cellpadding=3>
<caption><font size=-1><b></b></font></caption>
<tr valign=top><td><em>Parameter</em>:<em></em>
<p><td><code>colorSpace</code>
<p><td>A specific color space identified by one of the predefined class constants (e.g., <code>CS_sRGB</code>, <code>CS_LINEAR_RGB</code>, <code>CS_CIEXYZ</code>, <code>CS_GRAY</code>, or <code>CS_PYCC</code>).
<p>

</Table>

</a><P></dl>
<pre><ul>
<li>int getType()
<p></ul></pre><dl>
<a name="51499">
<dt><dd> returns the color space type of this <code>ColorSpace</code> (for example <code>TYPE_RGB</code>, <code>TYPE_XYZ</code>, etc.). 
</a><P></dl>
<a name="51500">
<h3>5.2.3	<img src="shared/space.gif">ICC Profile and ICC Color Space</h3>
</a>The <code>ColorSpace</code> class is an abstract class. It is expected that particular implementations of subclasses of <code>ColorSpace</code> will support high performance conversion based on underlying platform color management systems. The <code>ICC_ColorSpace</code> class is one such implementation provided in the base AWT. Developers can define their own subclasses to represent arbitrary color spaces, as long as the appropriate "to" and "from" conversion methods are implemented. However, most developers can simply use the default <code>sRGB</code> color space or color spaces that are represented by commonly-available ICC profiles, such as profiles for monitors and printers or profiles embedded in image data.<code></code>
<p>The <code>ICC_ColorSpace</code> class is based on ICC profile data as represented by the <code>ICC_Profile</code> class. The <code>ICC_Profile</code> class is a representation of color profile data for device-independent and device-dependent color spaces based on the <em>ICC Profile Format Specification</em>, Version 3.4, August 15, 1997, from the International Color Consortium. ICC profiles describe an <em>input space</em> and a <em>connection space</em>, and define how to map between them.
<p>The <code>ICC_Profile</code> class has two subclasses that correspond to the specific color types:
<p><ul>
<li><code>ICC_ProfileRGB</code>, which represents <code>TYPE_RGB</code> color spaces<p></ul><ul>
<li><code>ICC_ProfileGray</code>, which represents <code>TYPE_GRAY</code> color spaces<p></ul><a name="51516">
<h2>5.3	<img src="shared/space.gif">Transparency</h2>
</a>Just as images can have color, they can also have transparency. Transparency defines the specular transmission of light through transparent materials, such as glass, or the lack of transparency for completely opaque objects. The amount of transparency is specified by an alpha (<img src="shared/chars/alpha.gif">) value. An alpha value of 0.0 specifies complete translucency; an alpha value of 1.0 specifies complete opacity.
<p>Images can carry transparency information, known as the alpha channel, for each pixel in the image. The alpha value is particularly important when colors overlap. The alpha value specifies how much of the previously-rendered color should show through.
<p>The Java <code>Transparency</code> interface defines the common transparency modes for implementing classes. <a href="Color.doc.html#51528">Table &#32;5-2</a> lists the variables used to specify transparency.<p> 
<Table Border="3" cellpadding=3>
<caption><font size=-1><b><a name="51528">
<i>Table 5-2	 </i><img src="shared/sm-blank.gif" border=0> Transparency
</a></b></font></caption>
<tr valign=top><th><a name="51532">
Name
</a><th><a name="51534">
Description
</a>
<tr valign=top><td><a name="51537">
BITMASK</a><br><td><a name="51539">
Represents image data that is guaranteed to be either completely opaque, with an alpha value of 1.0, or completely transparent, with an alpha value of 0.0.</a><br>
<tr valign=top><td><a name="51542">
OPAQUE</a><br><td><a name="51544">
Represents image data that is guaranteed to be completely opaque, meaning that all pixels have an alpha value of 1.0.</a><br>
<tr valign=top><td><a name="51547">
TRANSLUCENT</a><br><td><a name="51549">
Represents image data that contains or might contain arbitrary alpha values between and including 0.0 and 1.0.</a><br>

</Table>

<p>Transparency is specified as part of the color model (see <a href="Color.doc.html#51226">Section &#32;5.2.1, "Color Models</a>").
<p><a name="51551">
<h2>5.4	<img src="shared/space.gif">Color Conversion</h2>
</a>The <code>ColorConvert</code> operation performs a pixel-by-pixel color conversion of the data in a rendered or renderable source image. The data are treated as having no alpha channel, i.e., all bands are color bands. The color space of the source image is specified by the <code>ColorSpace</code> object of the source image <code>ColorModel</code> which must not be null.
<p>JAI does not attempt to verify that the <code>ColorModel</code> of the destination image is consistent with the <code>ColorSpace</code> parameter. To ensure that this is the case, a compatible <code>ColorModel</code> must be provided via an <code>ImageLayout</code> in the <code>RenderingHints</code> (see <a href="Programming-environ.doc.html#55991">Section &#32;3.7.3, "Rendering Hints</a>").
<p>Integral data are assumed to occupy the full range of the respective data type; floating point data are assumed to be normalized to the range [0.0,1.0]. By default, the destination image bounds, data type, and number of bands are the same as those of the source image.
<p>The <code>ColorConvert</code> operation takes one parameter:<p> 
<Table Border="3" cellpadding=3>
<caption><font size=-1><b></b></font></caption>
<tr valign=top><th><a name="51557">
Parameters
</a><th><a name="51559">
Type
</a><th><a name="51561">
Description
</a>
<tr valign=top><td><a name="51563">
colorSpace</a><br><td><a name="51565">
ColorSpace</a><br><td><a name="51567">
The destination color space.</a><br>

</Table>

<p>For information on color space, see <a href="Color.doc.html#51305">Section &#32;5.2.2, "Color Space</a>."
<p><a href="Color.doc.html#51792">Listing &#32;5-1</a> shows a code sample for a <code>ColorConvert</code> operation.<p>
<caption><font size=-1><b>
<a name="51792">
<center><font size=-1><b><i>Listing 5-1	</i><img src="shared/sm-blank.gif" border=0> Example ColorConvert Operation</b></font></center>
</a><p>
</b></font></caption>
<hr>
<tr valign=top><td><pre>     // Read the image from the specified file name.
     RenderedOp src = JAI.create("fileload", fileName);
</pre>
<tr valign=top><td><pre>     // Create the ParameterBlock.
     ParameterBlock pb = new ParameterBlock();
     pb.addSource(src).add(colorSpace);
</pre>
<tr valign=top><td><pre>     // Perform the color conversion.
     RenderedOp dst = JAI.create("ColorConvert", pb);
</pre>

<hr>

<p><a name="51591">
<h2>5.5	<img src="shared/space.gif">Non-standard Linear Color Conversion (BandCombine)</h2>
</a>In JAI, the <code>BandCombine</code> operation performs a linear color conversion between color spaces other than those listed in <a href="Color.doc.html#51319">Table &#32;5-1</a>. The <code>BandCombine</code> operation computes a set of arbitrary linear combinations of the bands of a rendered or renderable source image, using a specified matrix. The matrix must have dimension (# of source bands plus one) by (# of desired destination bands).
<p>The <code>BandCombine</code> operation takes one parameter:<p> 
<Table Border="3" cellpadding=3>
<caption><font size=-1><b></b></font></caption>
<tr valign=top><th><a name="51599">
Parameter
</a><th><a name="51601">
Type
</a><th><a name="51603">
Description
</a>
<tr valign=top><td><a name="51605">
matrix</a><br><td><a name="51607">
double</a><br><td><a name="51609">
The matrix specifying the band combination.</a><br>

</Table>

<p>As an example, assume the three-band source image and the matrix shown in <a href="Color.doc.html#51639">Figure &#32;5-1</a>. The equation to calculate the value of the destination pixel in this example would be:
<p><dl>
<a name="51615">
<dt><dd> <em>dst</em> = (255 * 0.25) + (157 * 0.5) + (28 * 0.75)
</a><P><a name="51637">
 <hr>
<center><img src="Color.doc.anc.gif"></center><hr>

</a></dl>

<a name="51639">
<center><font size=-1><b><i>Figure 5-1	</i><img src="shared/sm-blank.gif" border=0> Band Combine Example</b></font></center>
</a><p>
In this example, the number of columns in the matrix is equal to the number of bands in the source image. The number of rows in the matrix must equal the number of bands in the destination image. For a destination image with three bands, the values in the second row of the matrix would be used to calculate the values in the second band of the destination image and the values in the third row would be used to calculate the values in the third band.
<p>If the result of the computation underflows or overflows the minimum or maximum value supported by the destination image, it will be clamped to the minimum or maximum value, respectively.
<p><a href="Color.doc.html#51816">Listing &#32;5-2</a> shows a code sample for a <code>BandCombine</code> operation.<p>
<caption><font size=-1><b>
<a name="51816">
<center><font size=-1><b><i>Listing 5-2	</i><img src="shared/sm-blank.gif" border=0> Example BandCombine Operation</b></font></center>
</a><p>
</b></font></caption>
<hr>
<tr valign=top><td><pre>     // Create the matrix.
     // Invert center band.
          double[][] matrix = {
                     { 1.0D,  0.0D, 0.0D,   0.0D },
                     { 0.0D, -1.0D, 0.0D, 255.0D },
                     { 0.0D,  0.0D, 1.0D,   0.0D },
                  };
</pre>
<tr valign=top><td><pre>     // Identity.
          double[][] matrix = {
                     { 1.0D, 0.0D, 0.0D, 0.0D },
                     { 0.0D, 1.0D, 0.0D, 0.0D },
                     { 0.0D, 0.0D, 1.0D, 0.0D },
                  };
</pre>
<tr valign=top><td><pre>     // Luminance stored into red band (3 band).
           double[][] matrix = {
                      { .114D, 0.587D, 0.299D, 0.0D },
                      { .000D, 0.000D, 0.000D, 0.0D },
                      { .000D, 0.000D, 0.000D, 0.0D }
                   };
</pre>
<tr valign=top><td><pre>     // Luminance (single band output).
           double[][] matrix = {
                      { .114D, 0.587D, 0.299D, 0.0D }
                   };
</pre>
<tr valign=top><td><pre>     // Create the ParameterBlock.
     ParameterBlock pb = new ParameterBlock();
     pb.addSource(src_image);
     pb.add(matrix);
</pre>
<tr valign=top><td><pre>     // Perform the band combine operation.
     dst = (PlanarImage)JAI.create("bandcombine", pb, null);
</pre>

<hr>

<p>
<p>
<hr><br>
 
<center>
<a href="JAITOC.fm.html"><img src="shared/contents.gif" alt="Contents"></a> <a href="Acquisition.doc.html"><img src="shared/previous.gif" alt="Previous"></a> <a href="Image-manipulation.doc.html"><img src="shared/next.gif" alt="Next"></a> <p><font size=5><i>Programming in Java Advanced Imaging</i></font>
</center>
<br>
 


<h5><a href="copyright.html">Copyright</a> &#169; 1999, Sun Microsystems, Inc.   All rights
reserved.</h5>


<!-- Last updated: Tue Nov 02 17:30:41 1999 -->
</blockquote>
</body>
</html>
